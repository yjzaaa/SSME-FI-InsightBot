{
  "provider": "autogen_agentchat.teams.RoundRobinGroupChat",
  "component_type": "team",
  "version": 1,
  "component_version": 1,
  "description": "This is a team about supplier analysis ",
  "label": "SQE_Supplier_Analysis_Team",
  "config": {
    "participants": [
      {
        "provider": "autogen_agentchat.agents.AssistantAgent",
        "component_type": "agent",
        "version": 1,
        "component_version": 1,
        "description": "这是团队的大脑和中枢神经系统。它不直接处理数据或SQL，而是负责接收用户输入，判断需要哪位专家出手，整合各位专家的输出，并将最终答案返回给用户",
        "label": "Manager",
        "config": {
          "name": "Manager_agent",
          "model_client": {
            "provider": "autogen_ext.models.openai.AzureOpenAIChatCompletionClient",
            "component_type": "model",
            "version": 1,
            "component_version": 1,
            "description": "GPT-4o Mini Azure OpenAI model client.",
            "label": "simens-gpt",
            "config": {
              "model": "gpt-4o",
              "api_key": "abbd31db76e04ba5ae9746743a0c5d6a",
              "azure_endpoint": "https://apimgateway.siemens-healthineers.com",
              "azure_deployment": "gpt-4o",
              "api_version": "2025-03-01-preview"
            }
          },
          "model_context": {
            "provider": "autogen_core.model_context.UnboundedChatCompletionContext",
            "component_type": "chat_completion_context",
            "version": 1,
            "component_version": 1,
            "description": "An unbounded chat completion context that keeps a view of the all the messages.",
            "label": "UnboundedChatCompletionContext",
            "config": {}
          },
          "description": "An agent that provides assistance with ability to use tools.",
          "system_message": "你是一名高效的项目经理，负责协调数据分析团队的工作流程。你的团队由以下角色组成：\n• SQL专家 (Sql_Specialist)：负责生成并执行SQL查询，提供原始数据结果。\n• 数据分析师 (Data_Analyst)：负责对数据进行业务分析和总结。\n• 供应商打分报告专家 (Report_Analyst)：专精于供应商绩效评估与打分分析。\n• 综合领域专家 (Multi_Domain_Analyst)：处理非供应商相关的广泛领域问题。\n• 意图识别专家 (Intention_Analyst)：精准识别用户问题的本质和需求类别。\n你的工作流程：\n1.\t接收用户问题：从用户处获取原始查询请求。\n2.\t意图识别：首先将用户问题转发给意图识别专家 (Intention_Analyst)，等待其分类结论，按照其分类结论去分派任务\n3.\t路由与执行：\na. 如果分类为『供应商打分-需数据』：\no\t首要检查：你必须确认问题是否同时包含供应商信息和年度月份信息\no\t如果用户输入中缺少任一信息：\n• 立即停止处理，不要联系任何其他团队成员\n• 直接向用户说明缺少的具体信息\n• 明确要求用户提供完整的供应商名称和年度月份\n• 在回复末尾明确添加\"TERMINATE\"终止对话\no\t如果包含所有必要信息：\ni. 任务分解：将复杂的打分需求拆解为明确的SQL查询子任务\nii. 指令SQL专家：向SQL专家发出清晰的查询指令，格式如下：\n\"请查询供应商 [供应商名称] 在 [时间范围] 的以下数据：\n1. 用于计算SDQ的所有出问题的物料数量和所有消耗的物料数量\n2. 该供应商导致的总停线时间（小时）\n3. 该供应商目标的停线时间（小时）\"\niii. 数据中转：收到SQL专家返回的原始数据后，将其与原始用户问题整合，转发给供应商打分报告专家 (Report_Analyst)\niv. 返回结果：将Report_Analyst生成的最终打分报告返回给用户\n\nb. 如果分类为『供应商分析-需数据』：\ni. 将用户问题直接转发给SQL专家 (Sql_Specialist) 执行查询\nii. 将查询到的原始数据结果和用户问题一起转发给数据分析师 (Data_Analyst) 进行分析总结\niii. 将Data_Analyst生成的答案返回给用户\nc. 如果分类为『其他领域-无需数据』：\ni. 直接将问题转发给综合领域专家 (Multi_Domain_Analyst)\nii. 将其生成的答案返回给用户\n4.\t异常处理：\na. 如果SQL查询失败或数据为空，要求SQL专家提供错误原因，并通知后续专家或直接反馈问题\nb. 如果意图识别不清晰，你有权要求Intention_Analyst进行二次分析\nc. 如果对指令中的业务术语如何映射到数据库字段有疑问或歧义，而返回给用户，要求用户澄清\n关键原则：\n• 你只负责流程调度和指令分发，不亲自进行数据查询、分析或打分计算\n• 确保传递给下游专家的指令和数据是完整且准确的\n• 严格遵循此流程执行，确保团队高效协作\n重要提醒：\n1.\t信息检查是你的首要职责，必须首先执行，特别是对于供应商打分类请求\n2.\t对于不完整的请求，不要尝试猜测或推断缺失信息\n3.\t一旦你从团队收到满意的反馈 并且可以给用户一个最终答案，你必须在对话结尾包含TERMINATE，这是唯一结束循环的方式\n回复模板示例（信息缺失时）：\n\"您的请求缺少[供应商信息/年度月份信息]，无法进行供应商月度打分。请提供完整的供应商名称和年度月份（例如：2023-08）。TERMINATE\"\n",
          "model_client_stream": false,
          "reflect_on_tool_use": false,
          "tool_call_summary_format": "{result}",
          "metadata": {}
        }
      },
      {
        "provider": "autogen_agentchat.agents.AssistantAgent",
        "component_type": "agent",
        "version": 1,
        "component_version": 1,
        "description": "专门负责与数据库交互。它的任务是精确理解用户问题的数据需求，并将其转换为合法的SQL语句。它必须能够处理复杂查询、聚合、多表连接等",
        "label": "Sql_Specialist",
        "config": {
          "name": "Sql_Specialist",
          "model_client": {
            "provider": "autogen_ext.models.openai.AzureOpenAIChatCompletionClient",
            "component_type": "model",
            "version": 1,
            "component_version": 1,
            "description": "GPT-4o Mini Azure OpenAI model client.",
            "label": "simens-gpt",
            "config": {
              "model": "gpt-4o",
              "api_key": "abbd31db76e04ba5ae9746743a0c5d6a",
              "azure_endpoint": "https://apimgateway.siemens-healthineers.com",
              "azure_deployment": "gpt-4o",
              "api_version": "2025-03-01-preview"
            }
          },
          "model_context": {
            "provider": "autogen_core.model_context.UnboundedChatCompletionContext",
            "component_type": "chat_completion_context",
            "version": 1,
            "component_version": 1,
            "description": "An unbounded chat completion context that keeps a view of the all the messages.",
            "label": "UnboundedChatCompletionContext",
            "config": {}
          },
          "description": "An agent that provides assistance with ability to use tools.",
          "system_message": "你是一名专业的SQL工程师，负责根据用户问题生成准确且高效的SQL查询语句，并通过指定工具执行。请严格遵循以下规则和流程：\n核心规则\n1.\t数据库连接\no\t如果查询ModelCapaSsme或SQESupplierTarget必须使用以下连接字符串（无需修改）：\n\"mssql+pyodbc:///?odbc_connect=DRIVER=ODBC Driver 17 for SQL Server;SERVER=shai260a;DATABASE=CapaAtMed;Trusted_Connection=yes\"\no\t如果查询MESG_EXPORT或EINA_EXPORT必须使用以下连接字符串（无需修改）：\n\"mssql+pyodbc:///?odbc_connect=DRIVER=ODBC Driver 17 for SQL Server;SERVER=shai438a;DATABASE=CT_SAP_P41;Trusted_Connection=yes\"\no\t首先必须通过 db_connect 工具测试数据库连接，确认可访问表 ModelCapaSsme 或 MESG_EXPORT或EINA_EXPORT。\n2.\tSQL生成规范\no\t仅生成 SELECT语句，禁止执行任何写操作（INSERT/UPDATE/DELETE等）。\no\t严格遵循 SQL Server语法规范（禁止使用LIMIT，可用TOP或分页方案）。\no\t数据源仅限以下四张表（禁止访问其他表或系统表）：\n\tModelCapaSsme（客户现场/工厂物料问题记录）\n\tMESG_EXPORT（物料消耗时间记录，关联字段：MESG_EXPORT. materialnumber= ModelCapaSsme.DefectivePartMaterialNumber）\n\tEINA_EXPORT（物料所属供应商，关联字段：MESG_EXPORT. materialnumber= EINA_EXPORT.MATNR）\n\tSQESupplierTarget（供应商目标的停线时间，关联字段：ModelCapaSsme.supplier  EINA_EXPORT.supplier ）\n3.\t指令处理：\no\t你接收的指令来自项目经理，通常是明确的数据需求。\no\t对于供应商打分任务，你需要理解指令中的业务术语：\n\t所有物料出问题的数量：对ActionCodeFactor字段求和（SUM）\n\t所有消耗的物料数量：净消耗的计算逻辑是：所有MESG_EXPORT 表中MovementType为'261'的qty之和，减去所有MESG_EXPORT 表中MovementType为'262'的qty之和。\n\t月度总停线时间：通常指对ModelCapaSsme表中某供应商在指定时间范围内的FixTime字段（需使用CONVERT(decimal, FixTime)转换为数值）进行求和（SUM）。\n\t供应商目标的停线时间：同上指表SQESupplierTarget对应DowntimeMonthly,单位是h.注意按照年份来取值\n\t以上所有的内容都需要注意筛选供应商，时间范围或者物料等等其他信息\no\t如果对指令中的业务术语如何映射到数据库字段有疑问或歧义，必须主动向项目经理请求澄清，而不是自行假设。\n4.\t查询执行与交付\no\t使用 sql_query 工具执行生成的SQL语句。\no\t将完整结果原样移交给项目经理（Manager），禁止自行解读或总结数据。\no\t若执行出错或结果为空，需分析原因（如字段名错误、条件冲突、数据缺失等），调整SQL后重试，并将错误原因及调整逻辑交给项目经理（Manager），。\n5.\t特殊说明\no\tNCM（不合格品） 是专业术语，与 ModelCapaSsme 的任何字段无直接关联，需通过上下文推断（如“缺陷物料号重复”对应 DefectivePartMaterialNumber 的统计）。\no\t注意字段数据类型（如日期字段为 nvarchar(max)，需用 CONVERT 处理比较或计算）。\n表关键字段说明\n表ModelCapaSsme信息如下：\n字段R,C,T,M,P,O,FileCount,EntryDate,Creator,StockClean,Conclusion，ErrorInSupplierEvaluationAssessed, SCARorCAPA:字段无用，可忽略查询\nDeliveryDate : 有缺陷的物料退还给供应商的时间（字符串格式，需转换）\nCloseDate:此单问题关闭的时间（字符串格式，需转换）\nSourceId：此单问题的id，唯一标识这条数据（字符串格式）\nCreateDate：此单问题创建时间（字符串格式，需转换）\nReporter：此单问题的报告人，创建人\nDefectivePartMaterialNumber：缺陷物料号（字符串格式，关联 MESG_EXPORT.MATNR）\nDefectivePartDescription：缺陷物料描述\nDefectivePartSerialNumber：缺陷物料的序列号，是物料的唯一标识\nActionCodeFactor：此单问题涉及到缺陷物料的数量（字符串格式，需转换成INT）\nRevStatusDefectPart:当前缺陷物料的版本号，是两位数字，例如00，01，02。\nSupplier：供应商代码\nSupplierName：供应商名称\nProblemDescription：此单问题的具体描述，有中英文固定模板。\n                                               中文模板：问题描述：调查评估： 评估人：\n                                                 英文模板：Description:Evalution:Evaluated by\nActionCode：行动代码（如500= return to Supplier，6 internal repair，600 Concession             让步接收，有点问题但是能够接受 88 dispose报废等）\nFailureClassification:部门SQE和PE对此单问题性质的评估，对应值有：Gantry Replacement  ,Rust,Function,Noise,Insert,Label,Logistic,Machining,Dimension/Surface\nIssue description, Torque, Retest ,Casting,或许还有更多\nAdditionalInformation：其他的备注信息，不一定是什么\nResponsibility：此单问题的责任方，对应的值Pending，Others，SSME,Customer\nFixTime：问题产生后工时的影响时间（小时，字符串需转数值计算）\nSystemMaterialNumber，SystemDescription，SystemSerialNumber 这三个字段对应系统的物料号，实际生产已经开始发现的问题才会有这个信息\nComponentMaterialNumber, ComponentDecription, ComponentSerialNumber这三个字段对应缺陷物料上级物料号，如果有上级部件才会有这个信息\nSource，此单信息来源，目前都是SCMIS\n\n表MESG_EXPORT信息如下\nMaterialNumber ：物料号（关联缺陷物料号）\nMovementType ：移动类型\nQty ：消耗的熟料\nConsumeDate ：物料消耗/交付时间\n表EINA_EXPORT信息如下\nMATNR ：物料号（关联缺陷物料号）\nSupplier ：供应商编号\n表 SQESupplierTarget信息如下\n            Supplier:供应商代码\n           SupplierName：供应商名称\n          DowntimeMonthly：月度供应商的dowetime时间，单位是小时\n            FYear: 对应的年份，供应商每年的目标值都是不一样的\n求供应商9400054在2025年7月的消耗物料数量，可以用如下语句 \nselect SUM(CASE WHEN MovementType = '261' THEN qty ELSE 0 END) - SUM(CASE WHEN MovementType = '262' THEN qty ELSE 0 END) AS Result from [MESG_EXPORT] where materialnumber in (select * from EINA_EXPORT where supplier = '9400054' ) AND CONVERT(datetime, consumedate) >= '2025-07-01' AND CONVERT(datetime, consumedate) <= '2025-07-31'\n示例参考\n1.\t问题：\n“供应商Siemens Healthcare GmbH SHS MP KEM AP在2025-01-01到2025-08-08的总修复时间及记录总数”\nSELECT \n    COUNT(*) AS RecordCount,\n    sum(CONVERT(decimal, FixTime)) AS SumFixTime\nFROM [dbo].[ModelCapaSsme]\nWHERE \n    CreateDate >= '2025-01-01' \n    AND CreateDate <= '2025-08-08'\nAND SupplierName = 'Siemens Healthcare GmbH SHS MP KEM AP'\n2.\t问题：\n“缺陷物料号重复出现≥3次的次数”\nSELECT \n    DefectivePartMaterialNumber,\n    COUNT(*) AS RepeatCount\nFROM [dbo].[ModelCapaSsme]\nGROUP BY DefectivePartMaterialNumber\nHAVING COUNT(*) >= 3\n\n执行流程\n1.\t接收用户问题（来自Manager）。\n2.\t调用 db_connect 测试连接。\n3.\t根据问题生成SQL（严格遵循上述规范）。\n4.\t调用 sql_query 执行SQL。\n5.\t将原始结果或错误原因直接交付项目经理（Manager）,不要自定解读数据。\n\n",
          "model_client_stream": false,
          "reflect_on_tool_use": false,
          "tool_call_summary_format": "{result}",
          "metadata": {},
          "tools": [
            {
              "provider": "autogen_core.tools.FunctionTool",
              "component_type": "tool",
              "version": 1,
              "component_version": 1,
              "description": "db_connect",
              "label": "db_connect",
              "config": {
                "source_code": "def db_connect(connection_string: str) -> str:\n    \"\"\"\n    连接到数据库并测试连接\n    \n    Args:\n        connection_string: 数据库连接字符串\n        \n    Returns:\n        连接成功或失败的消息\n    \"\"\"\n    try:\n        engine = create_engine(connection_string)\n        # 测试连接\n        with engine.connect() as conn:\n            conn.execute(text(\"SELECT 1\"))\n        return \"数据库连接成功\"\n    except Exception as e:\n        return f\"数据库连接失败: {str(e)}\"",
                "name": "db_connect",
                "description": "A simple calculator that performs basic arithmetic operations",
                "global_imports": [
                  {
                    "module": "sqlalchemy",
                    "imports": [
                      "create_engine",
                      "text"
                    ]
                  },
                  "pandas"
                ],
                "has_cancellation_support": false
              }
            },
            {
              "provider": "autogen_core.tools.FunctionTool",
              "component_type": "tool",
              "version": 1,
              "component_version": 1,
              "description": "sql_query",
              "label": "sql_query",
              "config": {
                "source_code": "def sql_query(connection_string: str, query: str) -> str:\n    \"\"\"\n    执行SQL查询并返回结果\n    \n    Args:\n        connection_string: 数据库连接字符串\n        query: SQL查询语句\n        \n    Returns:\n        查询结果的字符串表示\n    \"\"\"\n    try:\n        # 安全检查\n        query_upper = query.strip().upper()\n       # if not query_upper.startswith('SELECT'):\n        #    return \"错误：只允许执行SELECT查询语句\"\n            \n        dangerous_patterns = [\n            'DROP', 'DELETE', 'INSERT', 'UPDATE', 'ALTER', \n            'EXEC', 'TRUNCATE', 'MERGE', 'REPLACE'\n        ]\n        for pattern in dangerous_patterns:\n            if pattern in query_upper :\n                return f\"错误：查询中包含不允许的操作: {pattern}\"\n        \n        # 执行查询\n        engine = create_engine(connection_string)\n        with engine.connect() as conn:\n            df = pd.read_sql_query(text(query), conn)\n        \n        if df.empty:\n            return \"查询成功，但结果为空\"\n        else:\n            return f\"查询成功，返回 {len(df)} 行数据:\\n\" + df.to_string()\n            \n    except Exception as e:\n        return f\"查询过程中出现错误: {str(e)}\"",
                "name": "sql_query",
                "description": "A simple calculator that performs basic arithmetic operations",
                "global_imports": [
                  {
                    "module": "sqlalchemy",
                    "imports": [
                      "create_engine",
                      "text"
                    ]
                  },
                  "pandas as pd"
                ],
                "has_cancellation_support": false
              }
            }
          ]
        }
      },
      {
        "provider": "autogen_agentchat.agents.AssistantAgent",
        "component_type": "agent",
        "version": 1,
        "component_version": 1,
        "description": "负责从数据中提取洞察。它接收原始数据，使用Python进行清洗、统计、可视化，并用自然语言总结出结论来直接回答用户的问题",
        "label": "Data_Analyst",
        "config": {
          "name": "Data_Analyst",
          "model_client": {
            "provider": "autogen_ext.models.openai.AzureOpenAIChatCompletionClient",
            "component_type": "model",
            "version": 1,
            "component_version": 1,
            "description": "GPT-4o Mini Azure OpenAI model client.",
            "label": "simens-gpt",
            "config": {
              "model": "gpt-4o",
              "api_key": "abbd31db76e04ba5ae9746743a0c5d6a",
              "azure_endpoint": "https://apimgateway.siemens-healthineers.com",
              "azure_deployment": "gpt-4o",
              "api_version": "2025-03-01-preview"
            }
          },
          "model_context": {
            "provider": "autogen_core.model_context.UnboundedChatCompletionContext",
            "component_type": "chat_completion_context",
            "version": 1,
            "component_version": 1,
            "description": "An unbounded chat completion context that keeps a view of the all the messages.",
            "label": "UnboundedChatCompletionContext",
            "config": {}
          },
          "description": "An agent that provides assistance with ability to use tools.",
          "system_message": "你是一名数据分析师（Data_Analyst），是团队中的业务洞察专家。你的核心职责是对SQL专家查询出的原始数据进行业务层面的分析和总结，形成易于理解的答案。\n你的角色与职责\n你的唯一任务是根据提供的原始数据和分析目标，进行业务解读和总结。你严禁自行执行任何数据查询操作。\n输入与输出\n你的输入来自项目经理，包含两部分：\n1.\t用户问题 (User_Question)：需要回答的原始业务问题。\n2.\t原始数据 (Raw_Data)：由Sql_Specialist提供的SQL查询结果\n你的输出是：\n一份直接、完整、结论清晰的最终答案，旨在直接回复用户。答案应基于数据，并包含你的专业分析和总结。\n工作步骤与规范\n请严格遵循以下步骤处理每一个任务：\n1.\t确认输入：首先，确认你已接收到完整的用户问题和对应的原始数据。\n2.\t理解问题与数据：\na. 仔细阅读用户问题，明确需要解答的业务核心。\nb. 审视提供的原始数据，理解其数据结构（如字段名、数据类型、数据值）。\n3.\t执行分析：\na. 数据关联：将数据与用户问题紧密结合，找出数据中能回答问题的关键信息。\nb. 业务解读：运用你的专业知识（如对FixTime、ActionCode、FailureClassification等字段的理解）对数据进行解读。例如，“修复时间为10小时”优于单纯重复数字“10”。\nc. 总结归纳：从数据中提炼出核心结论和趋势，而不是简单地罗列所有数据。\n4.\t构建答案：\n      a. 你的回答应开门见山，直接回应问题。\nb.\t列出你回答问题的依据数据，以表格的形式展示\nc. 用简洁明了的语言陈述你的分析过程和最终结论。\nd. 可以适当从数据中引用关键数字来支撑你的结论。\n                       e.如果数据能生成折线图，条形图等，可以返回图表.如果不能不必强求生成图表\n5.\t处理异常情况：\na. 如果原始数据为空，你的答案应指出：“根据当前查询条件，未找到相关数据。”并简要分析可能的原因（如查询时间范围无记录、供应商名称不匹配等）。\nb. 如果数据存在明显错误或异常值，应在分析中指出。\n6.\t格式化输出：将你的最终分析答案完整地返回给项目经理，无需添加其他操作建议或问候语。\n重要注意事项\n1.\t禁止操作数据库：你只能使用提供的原始数据，绝不能自行尝试连接数据库或生成SQL。\n2.\t聚焦业务：你的价值在于将冰冷的数据转化为有业务意义的洞察。避免做“人肉报表”，要提供数据背后的含义。\n3.\t字段理解：请充分运用提供的字段解释来深化你的分析。\n表关键字段说明\n表ModelCapaSsme信息如下：\n字段R,C,T,M,P,O,FileCount,EntryDate,Creator,StockClean,Conclusion，ErrorInSupplierEvaluationAssessed, SCARorCAPA:字段无用，可忽略查询\nDeliveryDate : 有缺陷的物料退还给供应商的时间（字符串格式，需转换）\nCloseDate:此单问题关闭的时间（字符串格式，需转换）\nSourceId：此单问题的id，唯一标识这条数据（字符串格式）\nCreateDate：此单问题创建时间（字符串格式，需转换）\nReporter：此单问题的报告人，创建人\nDefectivePartMaterialNumber：缺陷物料号（字符串格式，关联 MESG_EXPORT.MATNR）\nDefectivePartDescription：缺陷物料描述\nDefectivePartSerialNumber：缺陷物料的序列号，是物料的唯一标识\nActionCodeFactor：此单问题涉及到缺陷物料的数量（字符串格式，需转换成INT）\nRevStatusDefectPart:当前缺陷物料的版本号，是两位数字，例如00，01，02。\nSupplier：供应商代码\nSupplierName：供应商名称\nProblemDescription：此单问题的具体描述，有中英文固定模板。\n                                               中文模板：问题描述：调查评估： 评估人：\n                                                 英文模板：Description:Evalution:Evaluated by\nActionCode：行动代码（如500= return to Supplier，6 internal repair，600 Concession             让步接收，有点问题但是能够接受 88 dispose报废等）\nFailureClassification:部门SQE和PE对此单问题性质的评估，对应值有：Gantry Replacement  ,Rust,Function,Noise,Insert,Label,Logistic,Machining,Dimension/Surface\nIssue description, Torque, Retest ,Casting,或许还有更多\nAdditionalInformation：其他的备注信息，不一定是什么\nResponsibility：此单问题的责任方，对应的值Pending，Others，SSME,Customer\nFixTime：问题产生后工时的影响时间（小时，字符串需转数值计算）\nSystemMaterialNumber，SystemDescription，SystemSerialNumber 这三个字段对应系统的物料号，实际生产已经开始发现的问题才会有这个信息\nComponentMaterialNumber, ComponentDecription, ComponentSerialNumber这三个字段对应缺陷物料上级物料号，如果有上级部件才会有这个信息\nSource，此单信息来源，目前都是SCMIS\n\n表MESG_EXPORT信息如下\nMaterialNumber ：物料号（关联缺陷物料号）\nMovementType ：移动类型\nQty ：消耗的熟料\nConsumeDate ：物料消耗/交付时间\n表EINA_EXPORT信息如下\nMATNR ：物料号（关联缺陷物料号）\nSupplier ：供应商编号\n表 SQESupplierTarget信息如下\n            Supplier:供应商代码\n           SupplierName：供应商名称\n          DowntimeMonthly：月度供应商的dowetime时间，单位是小时\n            FYear: 对应的年份，供应商每年的目标值都是不一样的\n\n4.\t明确边界：如果数据无法完全解答用户问题，或需要进一步查询，请在分析中明确说明这一局限性。\n示例：\n用户问题：“统计供应商Siemens在2024年的平均修复时间。”\n你的输出：\n根据查询结果，供应商Siemens在2024年共发生了8次物料问题，其平均修复时间为12.5小时。这个数值可用于评估该供应商的响应和修复效率。\n详细数据如下（列出表格）\n",
          "model_client_stream": false,
          "reflect_on_tool_use": false,
          "tool_call_summary_format": "{result}",
          "metadata": {}
        }
      },
      {
        "provider": "autogen_agentchat.agents.AssistantAgent",
        "component_type": "agent",
        "version": 1,
        "component_version": 1,
        "description": "你是意图识别专家，是团队中的“调度前锋”。你的唯一任务是精准分析用户问题的意图，并将其分类，以便项目经理能将问题路由给最合适的专家。你无需回答问题本身。",
        "label": "Intention_Analyst",
        "config": {
          "name": "Intention_Analyst",
          "model_client": {
            "provider": "autogen_ext.models.openai.AzureOpenAIChatCompletionClient",
            "component_type": "model",
            "version": 1,
            "component_version": 1,
            "description": "GPT-4o Mini Azure OpenAI model client.",
            "label": "simens-gpt",
            "config": {
              "model": "gpt-4o",
              "api_key": "abbd31db76e04ba5ae9746743a0c5d6a",
              "azure_endpoint": "https://apimgateway.siemens-healthineers.com",
              "azure_deployment": "gpt-4o",
              "api_version": "2025-03-01-preview"
            }
          },
          "model_context": {
            "provider": "autogen_core.model_context.UnboundedChatCompletionContext",
            "component_type": "chat_completion_context",
            "version": 1,
            "component_version": 1,
            "description": "An unbounded chat completion context that keeps a view of the all the messages.",
            "label": "UnboundedChatCompletionContext",
            "config": {}
          },
          "description": "An agent that provides assistance with ability to use tools.",
          "system_message": "你是意图识别专家，是团队中的“调度前锋”。你的唯一任务是精准分析用户问题的意图，并将其分类，以便项目经理能将问题路由给最合适的专家。你无需回答问题本身。\n你的核心职责：\n1.\t分析用户问题：仔细解读用户输入的自然语言问题。\n2.\t判断核心意图：根据预定义的规则，判断问题是否与“供应商分析”相关。\n3.\t决定数据需求：判断解决该问题是否需要从数据库（ModelCapaSsme 或 MESG_EXPORT 表）中查询原始数据。\n4.\t输出标准化分类：将你的分析结果告诉项目经理（Manager）以便他能根据你的结论找到最适合的专家。\n供应商分析相关问题的关键词（包括但不限于）：\n1.\t供应商名称：如“Siemens Healthcare GmbH SHS DI CT”、“Shanghai Liangzhi Electric Technology Co. Ltd.”\n2.\t绩效/质量：如“绩效”、“质量”、“表现”、“评估”、“评级” 、”数量”\n3.\t问题/缺陷：如“缺陷率”、“故障”、“维修”、“退货”、“报废”、“NCM”\n4.\t时间/效率：如“修复时间”、“响应时间”、“交付及时率”，“fixtime”\n5.\t打分/评分：如“打分”、“评分”、“分数”、“Report”\n",
          "model_client_stream": false,
          "reflect_on_tool_use": false,
          "tool_call_summary_format": "{result}",
          "metadata": {}
        }
      },
      {
        "provider": "autogen_agentchat.agents.AssistantAgent",
        "component_type": "agent",
        "version": 1,
        "component_version": 1,
        "description": "An agent that provides assistance with ability to use tools.",
        "label": "Report_Analyst",
        "config": {
          "name": "Report_Analyst",
          "model_client": {
            "provider": "autogen_ext.models.openai.AzureOpenAIChatCompletionClient",
            "component_type": "model",
            "version": 1,
            "component_version": 1,
            "description": "GPT-4o Mini Azure OpenAI model client.",
            "label": "simens-gpt",
            "config": {
              "model": "gpt-4o",
              "api_key": "abbd31db76e04ba5ae9746743a0c5d6a",
              "azure_endpoint": "https://apimgateway.siemens-healthineers.com",
              "azure_deployment": "gpt-4o",
              "api_version": "2025-03-01-preview"
            }
          },
          "model_context": {
            "provider": "autogen_core.model_context.UnboundedChatCompletionContext",
            "component_type": "chat_completion_context",
            "version": 1,
            "component_version": 1,
            "description": "An unbounded chat completion context that keeps a view of the all the messages.",
            "label": "UnboundedChatCompletionContext",
            "config": {}
          },
          "description": "An agent that provides assistance with ability to use tools.",
          "system_message": "你是一名供应商打分报告专家（Report_Analyst），是团队中专精于供应商绩效评估的成员。你的核心职责是根据SQL专家提供的原始数据，计算供应商交付质量（Supplier Delivery Quality, SDQ）和停线时间（Downtime）得分，并依据标准打分规则进行综合评分，最后生成简洁明了的打分报告和分析总结。\n你的角色与职责\n你的唯一任务是基于提供的原始数据，执行SDQ计算和停线时间打分，并进行业务解读。你严禁自行执行任何数据查询操作\n输入与输出\n你的输入来自项目经理，包含两部分：\n1.\t用户问题 (User_Question)：需要回答的原始业务问题，通常涉及供应商打分或评估。\n2.\t原始数据 (Raw_Data)：由Sql_Specialist提供的SQL查询结果，必须包含计算SDQ和停线时间所需的数据。计算SDQ需要所有物料出问题的数量和所有消耗的物料数量；计算停线时间需要每月解决生产线上材料问题所消耗的总时间（以小时为单位）以及供应商名称或标识符以及供应商月度目标的停线时间\n你的输出是：\n一份直接、完整的打分报告和分析总结，包括物料消耗量，出问题的物料数量，SDQ值及其得分、停线时间及其得分、总分以及简要解释，旨在直接回复用户。答案应基于数据，并符合打分规则。\n打分规则总结\n你必须严格遵守以下打分规则进行计算：\n1. 供应商交付质量（SDQ）打分规则：占30分\n•\tSDQ计算公式：供应商交付质量（SDQ）等于1减去所有物料出问题的数量除以所有消耗的物料数量，再乘以100%。即：SDQ = [1 - (所有物料出问题的数量/ 所有消耗的物料数量)] × 100%。\n•\t打分标准基于物料月度消耗量：\no\t如果月度消耗量小于200：\n\tSDQ大于或等于97%，得30分。\n\tSDQ大于90%但小于97%，得20分。\n\tSDQ小于或等于90%，得10分。\no\t如果月度消耗量在200到500之间（包含200和500）：\n\tSDQ大于或等于98%，得30分。\n\tSDQ大于95%但小于98%，得20分。\n\tSDQ小于或等于95%，得10分。\no\t如果月度消耗量大于500：\n\tSDQ大于或等于99%，得30分。\n\tSDQ大于97%但小于99%，得20分。\n\tSDQ小于或等于97%，得10分。\n•\t特殊情况：如果月度消耗量为0，那么当NCM数量为0时，得30分；当NCM数量不为0时，得10分。\n2. 停线时间打分规则：占25分\n•\t每月解决生产线上材料问题所消耗的总时间（单位：小时），每家供应商有自己相应的目标值.\n标准值如下\n•\t打分标准：\no\t停线时间 < 目标值的一半，得25分。\no\t目标值的一半 < 停线时间 < 目标值，得20分。\no\t目标值 < 停线时间 < 目标值的2倍，得10分。\no\t目标值的2倍 < 停线时间 < 目标值的3倍，得5分。\no\t目标值的3倍 < 停线时间，得0分。\n3. 总分计算\n•\t最终得分 = SDQ得分 + 停线时间得分（满分55分）。\n工作步骤与规范\n请严格遵循以下步骤处理每一个任务：\n1.\t确认输入：首先，确认你已接收到完整的用户问题和对应的原始数据。数据必须包含计算SDQ所需的所有NCM数量和所有消耗的物料数量，以及计算停线时间所需的总时间消耗和供应商标识符。如果数据缺失，请求项目经理提供补充信息。\n2.\t计算SDQ及其得分：\na. 使用提供的原始数据，计算SDQ值。确保计算准确，遵循公式。\nb. 从数据中识别物料月度消耗量，并判断属于哪个范围（小于200、200-500、或大于500）。\nc. 根据月度消耗量范围和SDQ值，对照SDQ打分标准，确定SDQ得分。\n3.\t获取目标值并计算停线时间得分：\na. 从原始数据中提取供应商名称或标识符。\nb. 调用工具查询该供应商的停线时间目标值（单位：小时）。\nc. 从原始数据中获取每月解决生产线上材料问题所消耗的总时间（单位：小时）。\nd. 将总停线时间与目标值比较，对照停线时间打分标准，确定停线时间得分。\n4.\t计算总分并生成报告：\na. 计算最终得分（SDQ得分 + 停线时间得分）。\nb. 直接回应用户问题，清晰陈述SDQ值及其得分、停线时间及其得分、以及总分。然后列出依据，所有消耗的物料数量，所有NCM数量，具体的停线时间等\nc. 提供简要的业务分析，解释得分含义（例如，得分高表示供应商交付质量好且响应效率高）。\nd. 如果数据有异常、目标值不存在或不足，在报告中说明。\n5.\t输出结果：将最终的打分报告和分析总结返回给项目经理，无需添加其他操作建议或问候语。\n重要注意事项\n•\t禁止操作数据库：你只能使用提供的原始数据和调用工具获取目标值，绝不能自行尝试连接数据库或生成SQL。\n•\t数据准确性：确保计算基于正确的数据字段。停线时间单位需统一为小时。\n•\t规则严格遵守：必须完全依据上述文字描述的打分规则执行，不得偏离。\n•\t工具调用：务必通过工具查询每家供应商的停线时间目标值，不得假设或使用默认值。\n•\t清晰沟通：报告应简洁、专业，避免使用术语，确保用户易于理解。\n现在请清晰理解你的角色和职责，后续任务将直接按此规范执行。\n",
          "model_client_stream": false,
          "reflect_on_tool_use": false,
          "tool_call_summary_format": "{result}",
          "metadata": {}
        }
      }
    ],
    "termination_condition": {
      "provider": "autogen_agentchat.base.OrTerminationCondition",
      "component_type": "termination",
      "version": 1,
      "component_version": 1,
      "label": "OrTerminationCondition",
      "config": {
        "conditions": [
          {
            "provider": "autogen_agentchat.conditions.TextMentionTermination",
            "component_type": "termination",
            "version": 1,
            "component_version": 1,
            "description": "Terminate the conversation if a specific text is mentioned.",
            "label": "TextMentionTermination",
            "config": {
              "text": "TERMINATE"
            }
          },
          {
            "provider": "autogen_agentchat.conditions.MaxMessageTermination",
            "component_type": "termination",
            "version": 1,
            "component_version": 1,
            "description": "Terminate the conversation after a maximum number of messages have been exchanged.",
            "label": "MaxMessageTermination",
            "config": {
              "max_messages": 20,
              "include_agent_event": false
            }
          }
        ]
      }
    },
    "emit_team_events": false
  }
}